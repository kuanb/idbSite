<!DOCTYPE html>

<html lang="en">

<head>
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Map Page</title>

    <!-- Bootstrap core CSS -->
    <link href="../lib/bootstrap.min.css" rel="stylesheet">

    <!-- Leaflet -->
    <link rel="stylesheet" href="../lib/leaflet.css" />
    <script src="../lib/leaflet.js"></script>

    <style>

      body {
        background-color: #d3d3d3;
      }
      .footer {
        position: absolute;
      }
      .bxslider {
        padding: 0px;
      }
      .slider_img {
        background-color: #d3d3d3;
      }
      .beneathMap {
        width:100%;
        height:300px;
        background-color: #f8f8f8;
        border-color: #e7e7e7;
      }
      .span_image {
        width: 100%;
      }
      .container {
        margin-bottom: 50px;
      }
    </style>

</head>

<body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation" style="z-score:9999">
      <div class="container" style="margin-bottom: 0px">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">H Maps</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#interactive">Interactive Map</a></li>
            <li><a href="#context">Context</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Geospatial Research <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li class="dropdown-header">Current Maps</li>
                <li><a href="#">Inland and Coastal Flooding</a></li>
                <li><a href="#">Hurricane Risk</a></li>
                <li><a href="#">Seismic Risk</a></li>
                <li><a href="#">Transport Study</a></li>
                <li><a href="#">Land Use</a></li>
              </ul>
            </li>
            <li><a href="#about">About</a></li>
            <li><a href="#idb">IDB</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <a id='interactive'></a>
    <div id="map" style="margin-top:50px;width:100%;height:400px;z-index:0">

    </div>

    <!-- This is the dynamic div that gets modified for the button click through... -->
    <div class="beneathMap">
        <div class="container" id="infoDiv">
            <h1>Such data and many maps</h1>
            <p>Lorem ipsum and much other such content for days and days because remember that. Lorem ipsum and much other such content for days and days because remember that. </p>
        </div>
        <div class="container" id="infoDiv_2">
            <h1>Explanation</h1>
            <p>This can be a placeholder.... The above will be like an explorative walk through of the site (e.g. a "Welcome to Haiti" dynamic walkthrough map) </p>
        </div>
    </div>

    <!-- The rest of the divs, stacked -->
    <a id='context'></a>
    <div>
        <!-- Overview -->
        <ul class="bxslider" id='slider01'>
            <li><img src="../static/maps/010_nationOverview.png" /></li>
            <li><img src="../static/maps/015_nationCities.png" /></li>
        </ul>
        <div class="container">
            <h1>Something nice about the above map...</h1>
            <p>Subtext, more nice things, blah blah blah...</p>
        </div>

        <!-- Northern area in detail -->
        <ul class="bxslider" id='slider02'>
            <li class='slider_img'><img src="../static/maps/020_newGrowth.png" />
                <div class='container'>
                    <h4>Test text blah</h4>
                </div>
            </li>
            <li class='slider_img'><img src="../static/maps/022_baseCorridors.png" />
                <div class='container'>
                    <h4>Number two blah</h4>
                </div>
            </li>
            <li class='slider_img'><img src="../static/maps/024_POIs.png" />
                <div class='container'>
                    <h4>Number three</h4>
                </div>
            </li>
            <li class='slider_img'><img src="../static/maps/025_northCorridors.png" />
                <div class='container'>
                    <h4>Number four</h4>
                </div>
            </li>
            <li class='slider_img'><img src="../static/maps/026_citiesPopulations.png" />
                <div class='container'>
                    <h4>Numbah fivee</h4>
                </div>
            </li>
        </ul>
        <div class="container">
            <h1>Something nice about the above map...</h1>
            <p>Subtext, more nice things, blah blah blah...</p>
        </div>
    </div>


    <!-- Abou section -->
    <a id='about'></a>
    <div>
        <div class="container">
            <h1>About this project</h1>
            <p>This is where we put who did what, yada yada. Lorem ipsum and much other such content for days and days because remember that. Lorem ipsum and much other such content for days and days because remember that. </p>
        </div>
    </div>

    <!-- IDB section -->
    <a id='idb'></a>
    <div>
        <div class="container">
            <h1>IDB logos</h1>
            <p>Span with logos and copy rights...  </p>
        </div>
    </div>

</body>

<!-- Bootstrap core JavaScript -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="../lib/jquery.min.js"></script>
<script src="../lib/bootstrap.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="../lib/ie10-viewport-bug-workaround.js"></script>

<!-- bxSlider Javascript file -->
<script src="../lib/jquery.bxslider.js"></script>
<!-- bxSlider CSS file -->
<link href="../lib/jquery.bxslider.css" rel="stylesheet" />

<script>

    $('#slider01').bxSlider({
        mode: 'fade',
        autoControls: true,
        pause: 3000
    });

    $('#slider02').bxSlider({
        mode: 'fade',
        autoControls: true,
        pause: 3000
    });

    // loads page elements like leaflet map and generates first view
    initPage = function() {
        // set map height
        document.getElementById('map').setAttribute('padding', window.innerHeight)
        document.getElementById('map').setAttribute('width', window.innerWidth)

        var map = L.map('map').setView([18.75, -72.000590], 3);

        // add an OpenStreetMap tile layer
        L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
        }).addTo(map);

        // remove leaflet (+/-) controls
        $(".leaflet-control-zoom").css("visibility", "hidden");

        introSequence(map)
    };

    // handles production of new map scenes
    introSequence = function(map) {

        // standard retrieval of different layer data
        standardRetrieve = function(filename, next) {
            $.ajax({
                url: '../src/geojson/' + filename,
                dataType: 'json',
                success: function(data) {
                    var returnedShape = data; 

                    // init intro to northern area
                    shownJSON.clearLayers();
                    shownJSON.addData(returnedShape);
                    map.fitBounds(shownJSON);

                    // clear out details blob
                    $('#infoDiv').empty();

                    // map title
                    var title = document.createElement('h1');
                        title.innerHTML = data.title;
                    document.getElementById('infoDiv').appendChild(title);

                    // map subtitle
                    var subtext = document.createElement('p');
                        subtext.innerHTML = data.description;
                    document.getElementById('infoDiv').appendChild(subtext);

                    // map next button
                    if (next !== undefined) {
                        var nextButton = document.createElement('button');
                                    nextButton.innerHTML = 'nextButton';
                                    nextButton.setAttribute('onclick', next + '()');
                        document.getElementById('infoDiv').appendChild(nextButton);   
                    };
                },
                error: function(xhr, status, err) {
                    console.log(status, err.toString());
                }
            });
        }

        // setting the standard visual style for all the geojsons
        var flatStyle = {
            "color": "#ff0000",
            "weight": 0,
            "opacity": 0.5
        };

        // we will be manipulating this to walk through intro to Haiti
        var shownJSON = L.geoJson(null, {
            style: flatStyle
        }).addTo(map);

        // run the draw of the first geojson
        setTimeout(function(){ standardRetrieve('country.geojson','northRegions') }, 1000);

        northRegions = function() { 
            standardRetrieve('northRegions.geojson');
        }

    }

    window.onload = initPage;

</script>


</html>
